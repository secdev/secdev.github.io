<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<title>Scapy</title>
<link rel="stylesheet" href="scapy.css" type="text/css">
</head>


<body>


<h1>Scapy</h1>

<ul>
<li> <a href="http://www.oreilly.com/catalog/9780596009632/"><img style="vertical-align:middle" height="30" border=0 alt="[Security Power Tools cover]" src="images/security_power_tools-cover.gif">&nbsp;Security Power Tools</a> was out in August 2007.
     I wrote a complete chapter on Scapy</li>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<li> If you like what I do, you can 
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
">
<input style="vertical-align:middle" type="image" src="https://www.paypal.com/en_US/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypal.com/fr_FR/i/scr/pixel.gif" width="1" height="1">
</form></li>
</ul>




<h2>About Scapy</h2>

<h3>What is Scapy</h3>
Scapy is a powerful interactive packet manipulation program. It is able to forge
or decode packets of a wide number of protocols, send them on the wire, capture them, match requests and
replies, and much more. It can easily handle most classical tasks like 
scanning, tracerouting, probing, unit tests, attacks or network discovery (it can replace 
hping, 85% of nmap, arpspoof, arp-sk, arping, tcpdump, tethereal, p0f, etc.).
It also performs 
very well at a lot of other specific tasks that most other tools can't handle,
like sending invalid frames, injecting your own 802.11 frames, 
combining technics (VLAN hopping+ARP cache poisoning, VOIP decoding on 
WEP encrypted channel, ...), etc. See <a href="http://scapy.readthedocs.io/en/latest/#interactive-tutorial">interactive tutorial</a> and <a href="demo.html">the quick demo: an interactive session (some examples may be outdated)</a>.


<h3>What makes scapy different from most other networking tools</h3>

First, with most other tools, you won't build someting the author did
not imagine.  These tools have been built for a specific goal and
can't deviate much from it.  For example, an ARP cache poisoning
program won't let you use double 802.1q encapsulation. Or try to find
a program that can send, say, an ICMP packet with padding (I said
padding, not payload, see?). In fact, each time you have a new need, you 
have to build a new tool.
<p>

Second, they usually confuse decoding and interpreting. Machines are good
at decoding and can help human beings with that. Interpretation is reserved
to human beings. Some programs try to mimic this behaviour. For instance they
say "this port is open" instead of "I received a SYN-ACK". Sometimes they 
are right. Sometimes not. It's easier for beginners, but when you
know what you're doing, you keep on trying to deduce what really happened from
the program's interpretation to make your own, which is hard because you lost
a big amount of information. And you often end up using <tt>tcpdump -xX</tt> to 
decode and interpret what the tool missed.

<p>

Third, even programs which only decode do not give you all the
information they received. The network's vision they give you is the
one their author thought was sufficient. But it is not complete, and
you have a bias. For instance, do you know a tool that reports the
padding ?
<p>

Scapy tries to overcome those problems. It enables you to build exactly the
packets you want. Even if I think stacking a 802.1q layer on top of TCP has no 
sense, it may have some for somebody else working on some product I don't know. 
Scapy has a flexible model that tries to avoid such arbitrary limits. 
You're free to put any value you want in any field you want, and stack them
like you want. You're an adult after all. 
<p>
In fact, it's like building a new tool each time, but instead of dealing with a hundred line C
program, you only write 2 lines of Scapy.
<p>
After a probe (scan, traceroute, etc.) Scapy always gives you the full 
decoded packets from the probe, before any interpretation. That means that you 
can probe once and interpret many times, ask for a traceroute and look
at the padding for instance. 



<h2>Scapy Project</h2>

Scapy runs natively on Linux, and on most Unixes with libpcap, libdnet and
their respective python wrapper (see <a href="portability.html">scapy's portability page</a>).

<p>
Scapy &lt; 2.x needs Python 2.4 or upcomming versions.<br>
Scapy &ge; 2.x needs Python 2.5 or upcomming versions.


<h3><a name="download" />Download</h3>
<ul>
<li><a href="https://github.com/secdev/scapy/">Development repository</a>
<li><a href="https://github.com/secdev/scapy/archive/v2.3.3.zip">Scapy 2.3.3</a>
<!--
<li><a href="http://scapy.net">Scapy 2.3.0 executable zip</a>
<li><a href="http://packages.debian.org/unstable/net/scapy.html">Scapy's debian package</a> (not always up to date)
<li><a href="http://dag.wieers.com/packages/scapy/">Scapy's RPM package</a> (not always up to date)
-->
<li><a href="https://github.com/secdev/scapy/commits/master">ChangeLog</a>
</ul>

<h3><a name="related" />Related projects</h3>
<ul>
<li><a href="http://www.secdev.org/projects/scapytain/">Scapytain</a>: a web application to store, organise and run test campaigns on top of Scapy
<li><a href="http://www.secdev.org/projects/UTscapy/">UTscapy</a>: Unit Testing with scapy (integrated with Scapy 2.x)
<li><a href="http://sid.rstack.org/index.php/Wifitap_EN">WifiTap</a>: Wi-Fi traffic injection
<li><a href="files/scapy-olsr.py">local copy of Scapy OLSR add-on</a>
</ul>


<h3><a name="help" />Help, documentation</h3>

<h4><a name="ml" />Mailing-list</h4>

Send questions, bug reports, suggestions, ideas, cool usages of Scapy, etc.
To avoid spam, you must subscribe to the mailing list to post.

<ul>
<li>To subscribe to the mailing-list, send a mail to <tt>scapy.ml-subscribe(at)secdev.org</tt>
<li>To send a mail to the mailing-list: <tt>scapy.ml(at)secdev.org</tt> 
<!--
<li>Web archive : <a href="http://news.gmane.org/gmane.comp.security.scapy.general">http://news.gmane.org/gmane.comp.security.scapy.general</a>
<li>NNTP, RSS, etc : <a href="http://gmane.org/info.php?group=gmane.comp.security.scapy.general">http://gmane.org/info.php?group=gmane.comp.security.scapy.general</a>
-->
</ul>


<h4><a name="doc" />Documents</h4>
<ul>
<li><a href="http://scapy.readthedocs.io/"><b>Official Online HTML documentation</b></a>
<li><a href="http://www.oreilly.com/catalog/9780596009632/"><img border=0 alt="[Security Power Tools cover]" height=25 src="images/security_power_tools-cover.gif"></a>
    <a href="http://www.oreilly.com/catalog/9780596009632/">Security Power Tools</a> where I wrote a complete chapter about Scapy.
<li><a href="demo.html">Quick demo: an interactive session</a>
<li><a href="build_your_own_tools.html">Building your own tools with Scapy</a>
<li><a href="portability.html">Scapy portability page</a>
<li>You will also find an article in the French <a href="http://www.linuxmag-france.org/produit.php?produit=107">Linux Magazine #52</a>
<li><a href="https://github.com/secdev/scapy/issues/new">Report bugs/wishes/patches here</a>
<li><a href="https://github.com/secdev/scapy/issues">Active tickets here</a>
</ul>

<h4><a name="slides" />Slides</h4>

<ul>
<li><a href="conf/scapy_pacsec05.pdf">Scapy's PacSec/core05 slides</a>  (<a href="conf/scapy_pacsec05.handout.pdf">printable version</a>)
<li><a href="conf/scapy_hack.lu.pdf">Scapy's Hack.lu 2005 slides</a>
<li><a href="conf/scapy_Aachen.pdf">Scapy's Summerschool Applied IT Security 2005 slides</a>
<li><a href="conf/scapy_T2.pdf">Scapy's T2'2005 slides</a>
<li><a href="conf/scapy_csw05.pdf">Scapy's CanSecWest/core05 slides</a>
<li><a href="conf/scapy_lsm2003.pdf">Scapy's LSM 2003 slides</a>
</ul>

<h4><a name="otherdoc" />Other documents on Scapy :</h4>
<ul>
<li>A Scapy tutorial: <a href="http://packetstorm.linuxsecurity.com/papers/general/blackmagic.txt">Packet Wizardry: Ruling the Network with Python</a> by Rob klein Gunnewiek.
<li><a href=http://pierre.droids-corp.org/scapy/README.openbsd>(now outdated) Scapy installation on OpenBSD 3.8 howto</a>
</ul>



<h3><a name="dev" />Development</h3>

Scapy development uses <a href="https://git-scm.com/">Git</a> version control system. Scapy reference repository is at
<a href="https://github.com/secdev/scapy/">https://github.com/secdev/scapy/</a>. It provides a ticket management service that I use to avoid forgetting patches or bugs.
<p>


<h4><a name="ongoingdev" />Ongoing developments</h4>

<ul>
<li>IPv6
<li>Session management
<li>Bluetooth
<li>...
</ul>

<h4><a name="knownbugs" />Known bugs</h4>
<ul>
<li>Link layer not well managed yet
<li>Does not give the right source IP for routes that use interface aliases (/proc/net/route reports only master interface)
<li>DNS packets not reassembled exactly as the original (no compression used)
<li>May miss packets under heavy load
<li>BPF filters do not work on PPP interfaces
</ul>


</body>
</html>

